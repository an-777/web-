<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªå‹•é–‹é—œé€£çµå·¥å…·</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        h2 { color: #333; }
        
        /* è¼¸å…¥æ¡†æ¨£å¼ */
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
            margin-bottom: 10px;
            box-sizing: border-box; /* ç¢ºä¿ padding ä¸æœƒæ’é–‹å¯¬åº¦ */
        }

        /* æŒ‰éˆ•å€åŸŸ */
        .controls { margin-bottom: 20px; }
        button {
            padding: 10px 25px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover { background-color: #0056b3; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        /* ç´€éŒ„å€å¡Š */
        .log { 
            padding: 15px; 
            background: #f8f9fa; 
            border: 1px solid #ddd; 
            height: 200px; 
            overflow-y: auto; /* å…§å®¹å¤ªå¤šæ™‚å‡ºç¾å·è»¸ */
            font-family: monospace;
        }
        .item { margin-bottom: 5px; border-bottom: 1px dashed #eee; padding-bottom: 2px; }
        .success { color: green; }
        .error { color: red; font-weight: bold; }
        .info { color: #555; }
    </style>
</head>
<body>

    <h2>è‡ªå‹•ç¶²å€é–‹å•Ÿå™¨ (3ç§’å¾Œè‡ªå‹•é—œé–‰)</h2>
    
    <p>è«‹åœ¨ä¸‹æ–¹è¼¸å…¥ç¶²å€ (ä¸€è¡Œä¸€å€‹)ï¼Œä¾‹å¦‚ï¼š<br>
    <small style="color:gray">google.com<br>https://yahoo.com.tw</small></p>

    <textarea id="urlInput" placeholder="è«‹åœ¨æ­¤è²¼ä¸Šç¶²å€ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€å€‹æ–°çš„é€£çµ...">https://www.google.com
https://www.wikipedia.org
bing.com</textarea>

    <div class="controls">
        <button id="btnStart" onclick="startProcess()">ğŸš€ é–‹å§‹åŸ·è¡Œ</button>
        <span id="statusText" style="margin-left: 10px; font-weight: bold; color: #d9534f;"></span>
    </div>

    <h3>åŸ·è¡Œç´€éŒ„ï¼š</h3>
    <div id="logArea" class="log">æº–å‚™å°±ç·’...</div>

    <script>
        const logArea = document.getElementById('logArea');
        const btnStart = document.getElementById('btnStart');
        const statusText = document.getElementById('statusText');

        function log(message, type = 'item') {
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `[${new Date().toLocaleTimeString()}] ${message}`;
            logArea.appendChild(div);
            logArea.scrollTop = logArea.scrollHeight; // è‡ªå‹•æ²å‹•åˆ°åº•éƒ¨
        }

        async function startProcess() {
            // 1. å–å¾—ä½¿ç”¨è€…è¼¸å…¥ä¸¦è™•ç†æ ¼å¼
            const rawText = document.getElementById('urlInput').value;
            // æ ¹æ“šæ›è¡Œç¬¦è™Ÿåˆ†å‰²ï¼Œä¸¦éæ¿¾æ‰ç©ºç™½è¡Œ
            let urls = rawText.split('\n').map(u => u.trim()).filter(u => u.length > 0);

            if (urls.length === 0) {
                alert("è«‹å…ˆè¼¸å…¥ç¶²å€ï¼");
                return;
            }

            // é–å®šæŒ‰éˆ•é¿å…é‡è¤‡é»æ“Š
            btnStart.disabled = true;
            logArea.innerHTML = ""; // æ¸…ç©ºç´€éŒ„
            log("é–‹å§‹è™•ç†ä½‡åˆ—...", "info");

            for (let i = 0; i < urls.length; i++) {
                let url = urls[i];

                // 2. ç°¡å–®æª¢æŸ¥ç¶²å€æ ¼å¼ï¼Œå¦‚æœæ²’æœ‰ http é–‹é ­è‡ªå‹•è£œä¸Š
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }

                statusText.innerText = `æ­£åœ¨åŸ·è¡Œ (${i + 1}/${urls.length})`;
                log(`æº–å‚™é–‹å•Ÿ: ${url}`, "info");

                // 3. é–‹å•Ÿè¦–çª—
                const newWin = window.open(url, '_blank', 'width=1024,height=768');

                if (!newWin) {
                    log(`âŒ è¦–çª—è¢«ç€è¦½å™¨æ””æˆªï¼è«‹å…è¨±æ­¤ç¶²ç«™çš„å½ˆå‡ºè¦–çª—æ¬Šé™ã€‚`, "error");
                    statusText.innerText = "è¢«æ””æˆª";
                    btnStart.disabled = false;
                    return; // åœæ­¢åŸ·è¡Œ
                }

                // 4. ç­‰å¾… 3 ç§’
                await new Promise(resolve => setTimeout(resolve, 3000));

                // 5. é—œé–‰è¦–çª—
                if (!newWin.closed) {
                    newWin.close();
                    log(`âœ… å·²è‡ªå‹•é—œé–‰`, "success");
                } else {
                    log(`âš ï¸ ä½¿ç”¨è€…å·²æ‰‹å‹•é—œé–‰`, "info");
                }

                // (é¸ç”¨) æ¯å€‹å¾ªç’°ä¸­é–“ç·©è¡ 1 ç§’
                await new Promise(resolve => setTimeout(resolve, 1000));
            }

            statusText.innerText = "å…¨éƒ¨å®Œæˆ";
            log("<strong>æ‰€æœ‰ä»»å‹™å·²åŸ·è¡Œå®Œç•¢ã€‚</strong>", "info");
            btnStart.disabled = false;
        }
    </script>
</body>
</html>
